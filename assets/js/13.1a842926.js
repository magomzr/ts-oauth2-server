(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{279:function(t,e,a){"use strict";a.r(e);var s=a(13),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"authorization-code-grant-w-pkce"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#authorization-code-grant-w-pkce"}},[t._v("#")]),t._v(" Authorization Code Grant (w/ PKCE)")]),t._v(" "),e("p",[t._v("A temporary code that the client will exchange for an access token. The user authorizes the application, they are redirected back to the application with a temporary code in the URL. The application exchanges that code for the access token.")]),t._v(" "),e("h3",{attrs:{id:"flow"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#flow"}},[t._v("#")]),t._v(" Flow")]),t._v(" "),e("h4",{attrs:{id:"part-one"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#part-one"}},[t._v("#")]),t._v(" Part One")]),t._v(" "),e("p",[t._v("The client redirects the user to the "),e("code",[t._v("/authorize")]),t._v(" with the following query parameters:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("response_type")]),t._v(" must be set to "),e("code",[t._v("code")])]),t._v(" "),e("li",[e("strong",[t._v("client_id")]),t._v(" is the client identifier you received when you first created the application")]),t._v(" "),e("li",[e("strong",[t._v("redirect_uri")]),t._v(" indicates the URL to return the user to after authorization is complete, such as org.example.app://redirect")]),t._v(" "),e("li",[e("strong",[t._v("state")]),t._v(" is a random string generated by your application, which you’ll verify later")]),t._v(" "),e("li",[e("strong",[t._v("code_challenge")]),t._v(" must match the The code challenge as generated below,")]),t._v(" "),e("li",[e("strong",[t._v("code_challenge_method")]),t._v(" – Either "),e("code",[t._v("plain")]),t._v(" or "),e("code",[t._v("S256")]),t._v(", depending on whether the challenge is the plain verifier string or the SHA256 hash of the string. If this parameter is omitted, the server will assume plain.")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The client secret "),e("strong",[t._v("should never")]),t._v(" be used during the Part One of the authorization_code flow.")])]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("View sample authorization_code (part 1) request")]),t._v(" "),e("div",{staticClass:"language-http request extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token method property"}},[t._v("GET")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token request-target url"}},[t._v("/authorize")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("example.com")])]),t._v('\n\nresponse_type=code\n&client_id=xxxxxxx\n&redirect_uri=http://localhost\n&scope="contacts.read contacts.write"\n&state=abcdefghijklmnopqrstuvwxyz123456789\n&code_challenge=92d3b56942866d1edf02c33339b7c3dc37c6201282bb238cb47f0d3289f28a93f1bdd8af6ca9913aed0c4c\n&code_challenge_method=S256\n')])])])]),t._v(" "),e("p",[t._v("The user will be asked to login to the authorization server and approve the client and requested scopes.")]),t._v(" "),e("p",[t._v("If the user approves the client, they will be redirected from the authorization server to the provided "),e("code",[t._v("redirect_uri")]),t._v(" with the following fields in the query string:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("code")]),t._v(" is the authorization code that will soon be exchanged for a token")]),t._v(" "),e("li",[e("strong",[t._v("state")]),t._v(" is the random string provided and should be compared against the initially provided state")])]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("View sample authorization_code (part 1) response")]),t._v(" "),e("div",{staticClass:"language-http request extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token response-status"}},[e("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token status-code number"}},[t._v("302")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[t._v("Found")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Location")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("http://localhost&code=eyJhbGciOiJIUzI1NiJ9.eyJjbGllbnRfaWQiOiJhdXRoY29kZWNsaWVudCIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3QiLCJhdXRoX2NvZGVfaWQiOiJteS1zdXBlci1zZWNyZXQtYXV0aC1jb2RlIiwic2NvcGVzIjpbXSwiZXhwaXJlX3RpbWUiOjE2MDE3NTM3MzMsImNvZGVfY2hhbGxlbmdlIjoiT0RRd1pHTTRZelpsTnpNeU1qUXlaREF4WWpFNU1XWmtZMlJrTmpKbU1UbGxNbUkwTnpJMFpEbGtNR0psWWpGbE1tTXhPV1kyWkRJMVpEZGpNak13WWciLCJjb2RlX2NoYWxsZW5nZV9tZXRob2QiOiJTMjU2In0.OIEtZN5BHNaB4Mz0plUpGAP93EHyoil2smJiG3S_2BM&state=abcdefghijklmnopqrstuvwxyz123456789")])]),t._v("\n")])])])]),t._v(" "),e("h4",{attrs:{id:"part-two"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#part-two"}},[t._v("#")]),t._v(" Part Two")]),t._v(" "),e("p",[t._v("The client sends a "),e("strong",[t._v("POST")]),t._v(" to the "),e("code",[t._v("/token")]),t._v(" endpoint with the following body:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("grant_type")]),t._v(" must be set to "),e("code",[t._v("authorization_code")])]),t._v(" "),e("li",[e("strong",[t._v("client_id")]),t._v(" is the client identifier you received when you first created the application")]),t._v(" "),e("li",[e("strong",[t._v("client_secret")]),t._v(" (optional) is the client secret and should only be provided if the client is confidential")]),t._v(" "),e("li",[e("strong",[t._v("redirect_uri")])]),t._v(" "),e("li",[e("strong",[t._v("code_verifier")])]),t._v(" "),e("li",[e("strong",[t._v("code")]),t._v(" is the authorization code from the query string")])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Private Key Leak Potential")]),t._v(" "),e("p",[t._v("Clients such as Browser Based Apps and Native Mobile Apps should "),e("strong",[t._v("NEVER")]),t._v(" have or use a client_secret. That means the client_secret should be omitted both when initially creating the OAuthClient entity, and when making requests.")])]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("View sample authorization_code (part 2) request")]),t._v(" "),e("div",{staticClass:"language-http request extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token method property"}},[t._v("POST")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token request-target url"}},[t._v("/token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("example.com")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("application/x-www-form-urlencoded")])]),t._v("\n\ngrant_type=authorization_code\n&client_id=xxxxxxxxxx\n&client_secret=xxxxxxxxxx\n&redirect_uri=http://localhost\n&code_verifier=OTJkM2I1Njk0Mjg2NmQxZWRmMDJjMzMzMzliN2MzZGMzN2M2MjAxMjgyYmIyMzhjYjQ3ZjBkMzI4OWYyOGE5M2YxYmRkOGFmNmNhOTkxM2FlZDBjNGM\n&code=eyJhbGciOiJIUzI1NiJ9.eyJjbGllbnRfaWQiOiJhdXRoY29kZWNsaWVudCIsInJlZGlyZWN0X3VyaSI6Imh0dHA6Ly9sb2NhbGhvc3QiLCJhdXRoX2NvZGVfaWQiOiJteS1zdXBlci1zZWNyZXQtYXV0aC1jb2RlIiwic2NvcGVzIjpbXSwiZXhwaXJlX3RpbWUiOjE2MDE3NTM3MzMsImNvZGVfY2hhbGxlbmdlIjoiT0RRd1pHTTRZelpsTnpNeU1qUXlaREF4WWpFNU1XWmtZMlJrTmpKbU1UbGxNbUkwTnpJMFpEbGtNR0psWWpGbE1tTXhPV1kyWkRJMVpEZGpNak13WWciLCJjb2RlX2NoYWxsZW5nZV9tZXRob2QiOiJTMjU2In0.OIEtZN5BHNaB4Mz0plUpGAP93EHyoil2smJiG3S_2BM\n")])])])]),t._v(" "),e("p",[t._v("The authorization server will respond with the following response")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("token_type")]),t._v(" will always be "),e("code",[t._v("Bearer")])]),t._v(" "),e("li",[e("strong",[t._v("expires_in")]),t._v(" is the time the token will live in seconds")]),t._v(" "),e("li",[e("strong",[t._v("access_token")]),t._v(" is a JWT signed token and is used to authenticate into the resource server")]),t._v(" "),e("li",[e("strong",[t._v("refresh_token")]),t._v(" is a JWT signed token and can be used in with the "),e("a",{attrs:{href:"#refresh-token-grant"}},[t._v("refresh grant")])]),t._v(" "),e("li",[e("strong",[t._v("scope")]),t._v(" is a space delimited list of scopes the token has access to")])]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("View sample authorization_code (part 2) response")]),t._v(" "),e("div",{staticClass:"language-http request extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token response-status"}},[e("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token status-code number"}},[t._v("200")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[t._v("OK")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("application/json; charset=UTF-8")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("no-store")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Pragma")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("no-cache")])]),t._v("\n\n{\n  token_type: 'Bearer',\n  expires_in: 3600,\n  access_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2MDE3NTUxMDQsIm5iZiI6MTYwMTc1MTUwNCwiaWF0IjoxNjAxNzUxNTA0LCJqdGkiOiJuZXcgdG9rZW4iLCJjaWQiOiJ0ZXN0IGF1dGggY29kZSBjbGllbnQiLCJzY29wZSI6IiJ9.-V9x03iz-3ISRMdj9m1-FCKjmtfjvv6wqnBj6VZdW28',\n  refresh_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJjbGllbnRfaWQiOiJhdXRoY29kZWNsaWVudCIsImFjY2Vzc190b2tlbl9pZCI6Im5ldyB0b2tlbiIsInJlZnJlc2hfdG9rZW5faWQiOiJ0aGlzLWlzLW15LXN1cGVyLXNlY3JldC1yZWZyZXNoLXRva2VuIiwic2NvcGUiOiIiLCJleHBpcmVfdGltZSI6MTYwMTc1NTEwNCwiaWF0IjoxNjAxNzUxNTAzfQ.J_RUFD5-158atTmI98R95vowZWi4mUEXYCO7iNwzpK4',\n  scope: 'contacts.read contacts.write'\n}\n")])])])]),t._v(" "),e("h3",{attrs:{id:"pkce"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pkce"}},[t._v("#")]),t._v(" PKCE")]),t._v(" "),e("p",[t._v("PKCE ("),e("a",{attrs:{href:"https://tools.ietf.org/html/rfc7636",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC 7636"),e("OutboundLink")],1),t._v(") is an extension to the "),e("a",{attrs:{href:"https://oauth.net/2/grant-types/authorization-code/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Authorization Code flow"),e("OutboundLink")],1),t._v(" to prevent several attacks and to be able to securely perform the OAuth exchange from public clients.")]),t._v(" "),e("p",[t._v("By default, PKCE is enabled and encouraged for all users. If you need to support a legacy client system without PKCE, you can disable PKCE with the authorization server:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('const authorizationServer = new AuthorizationServer(\n  authCodeRepository,\n  clientRepository,\n  accessTokenRepository,\n  scopeRepository,\n  userRepository,\n  new JwtService("secret-key"),\n  {\n    requiresPKCE: false,\n  }\n);\n')])])]),e("h4",{attrs:{id:"code-verifier"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#code-verifier"}},[t._v("#")]),t._v(" Code Verifier")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("code_verifier")]),t._v(" is part of the extended "),e("a",{attrs:{href:"https://tools.ietf.org/html/rfc7636",target:"_blank",rel:"noopener noreferrer"}},[t._v("“PKCE”"),e("OutboundLink")],1),t._v(" and helps mitigate the threat of having authorization codes intercepted.")]),t._v(" "),e("p",[t._v("Before initializing "),e("a",{attrs:{href:"#part-one"}},[t._v("Part One")]),t._v(" of the authorization code flow, the client first creats a "),e("code",[t._v("code_verifier")]),t._v(". This is a cryptographically random string using the characters A-Z, a-z, 0-9, and the punctuation characters "),e("code",[t._v("-._~")]),t._v(" (hyphen, period, underscore, and tilde), between 43 and 128 characters long.")]),t._v(" "),e("p",[t._v("We can do this in Node using the native crypto package and a "),e("code",[t._v("base64urlencode")]),t._v(" function:")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" crypto "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"crypto"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" code_verifier "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" crypto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("randomBytes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("43")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hex"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("@see "),e("a",{attrs:{href:"https://www.oauth.com/oauth2-servers/pkce/authorization-request/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.oauth.com/oauth2-servers/pkce/authorization-request/"),e("OutboundLink")],1)]),t._v(" "),e("h4",{attrs:{id:"code-challenge"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#code-challenge"}},[t._v("#")]),t._v(" Code Challenge")]),t._v(" "),e("p",[t._v("Now we need to create a "),e("code",[t._v("code_challenge")]),t._v(" from our "),e("code",[t._v("code_verifier")]),t._v(".")]),t._v(" "),e("p",[t._v("For devices that can perform a SHA256 hash, the code challenge is a BASE64-URL-encoded string of the SHA256 hash of the code verifier.")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" code_challenge "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64urlencode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  crypto"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createHash")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sha256"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code_verifier"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Clients that do not have the ability to perform a SHA256 hash are permitted to use the plain "),e("code",[t._v("code_verifier")]),t._v(" string as the "),e("code",[t._v("code_challenge")]),t._v(".")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" code_challenge "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" code_verifier"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("Need a base64urlencode function?")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("base64urlencode")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Buffer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("from")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("str"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"base64"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\+")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("\\/")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token regex"}},[e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),e("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("g")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),e("h3",{attrs:{id:"revocation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#revocation"}},[t._v("#")]),t._v(" Revocation")]),t._v(" "),e("p",[t._v("Authorization codes are only valid for a single use. In addition, they can be explicitly revoked on a server that supports\n"),e("a",{attrs:{href:"https://tools.ietf.org/html/rfc7009",target:"_blank",rel:"noopener noreferrer"}},[t._v("RFC7009 “OAuth 2.0 Token Revocation”"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("An authorization code revocation request will include the following parameters:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("token")]),t._v(" is the authorization code previously issued to the client")]),t._v(" "),e("li",[e("strong",[t._v("token_type_hint")]),t._v(" (optional) should be set to "),e("code",[t._v("authorization_code")])])]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("View sample revoke authorization_code request")]),t._v(" "),e("div",{staticClass:"language-http request extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token method property"}},[t._v("POST")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token request-target url"}},[t._v("/token")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("example.com")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("application/x-www-form-urlencoded")])]),t._v("\n\ntoken_type_hint=authorization_code\n&refresh_token=xxxxxxxxx\n")])])])]),t._v(" "),e("p",[t._v("The authorization server will respond with the following response")]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("View sample revoke authorization_code response")]),t._v(" "),e("div",{staticClass:"language-http request extra-class"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token response-status"}},[e("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token status-code number"}},[t._v("200")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[t._v("OK")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("no-store")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token header"}},[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Pragma")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("no-cache")])]),t._v("\n")])])])])])}),[],!1,null,null,null);e.default=r.exports}}]);